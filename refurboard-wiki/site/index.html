<!DOCTYPE html>
<html>

<head>

    <title>Refurboard Field Guide - Refurboard</title>
    <style>
      /* load heading font */
      @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400');
      @import url('https://fonts.googleapis.com/css2?family=Poppins:ital,wght@400');
      @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@700');
      @import url('https://fonts.googleapis.com/css2?family=Poppins:ital,wght@700');

      /* load body font */
      @import url('https://fonts.googleapis.com/css2?family=Noto Sans:wght@400');
      @import url('https://fonts.googleapis.com/css2?family=Noto Sans:ital,wght@400');
      @import url('https://fonts.googleapis.com/css2?family=Noto Sans:wght@700');
      @import url('https://fonts.googleapis.com/css2?family=Noto Sans:ital,wght@700');

      /* load mono font */
      @import url('https://fonts.googleapis.com/css2?family=JetBrains Mono:wght@400');
      @import url('https://fonts.googleapis.com/css2?family=JetBrains Mono:ital,wght@400');
      @import url('https://fonts.googleapis.com/css2?family=JetBrains Mono:wght@700');
      @import url('https://fonts.googleapis.com/css2?family=JetBrains Mono:ital,wght@700');

      /* load emoji font */
      @font-face {
        font-family: "Noto Color Emoji";
        src: url('assets/fonts/emoji/NotoColorEmoji-Regular.ttf');
        font-weight: 400;
      }
  
      :root {
        /* colors */
        --primary: #05b2dc;
        --secondary: #ef9B0f;
        --tertiary: #ef3e36;
        /* shades */
        --base: #ffffff;
        --mantle: #f5f4f5;
        --crust: #d4d2d5;
        --overlay: #aBaBaE;
        --footer: #000000cc;
        /* text */
        --text: #343233;
        --hltext: #ffffff;
        color: var(--text);
        /* background-specific text */
        --primary-text: var(--hltext);
        --secondary-text: var(--hltext);
        --tertiary-text: var(--hltext);
        --base-text: var(--text);
        --mantle-text: var(--text);
        --crust-text: var(--text);
        --overlay-text: var(--hltext);
        --footer-text: var(--hltext);
        /* fonts */
        --heading: Poppins, Noto Color Emoji;
        --body: Noto Sans, Noto Color Emoji;
        --mono: JetBrains Mono, Noto Color Emoji;
        font-family: var(--body); 
      }
      /* dark mode */
      @media (prefers-color-scheme: dark) {
        :root {
          /* colors */
          --primary: #05b2dc;
          --secondary: #ef9B0f;
          --tertiary: #ef3e36;
          /* shades */
          --base: #343233;
          --mantle: #373536;
          --crust: #3E3C3D;
          --overlay: #646461;
          --footer: #00000022;
          /* text */
          --text: #ffffff;
          --hltext: #343233;
          color: var(--text);
          /* background-specific text */
          --primary-text: var(--text);
          --secondary-text: var(--text);
          --tertiary-text: var(--text);
          --base-text: var(--text);
          --mantle-text: var(--text);
          --crust-text: var(--text);
          --overlay-text: var(--hltext);
          --footer-text: var(--text);
        }
      }
      /* style settings */
      header#header {
        grid-template-columns: 8rem auto 8rem;
      }
      body#background {
        background: fixed center/cover var(--base);
        
        
      }
      #background-gradient {
        background: linear-gradient(
          45deg, 
          color-mix(in srgb, var(--mantle) 80%, transparent), transparent, color-mix(in srgb, var(--crust) 20%, transparent)
        );
      }
      content#content {
        padding: 0 3rem;
        background: color-mix(in srgb, var(--base) 0%, transparent);
        border-left: none;
        border-right: none;
      }
      #avatar {
        
        border-radius: 1rem;
        
      }
      footer#footer a {
        color: #ef9B0f;
      }
      footer#footer a:hover {
        color: #ef3e36;
      }
    </style>
    <link rel="icon" type="image/x-icon" href=assets/logo.ico>
    <link href="css/style.css" rel="stylesheet">
    <link href="css/responsivity.css" rel="stylesheet">  
    <script src="search/main.js"></script>
    <script src="https://kit.fontawesome.com/b57355f8ac.js" crossorigin="anonymous"></script>
    <script id="altmetric-embed-js" src="https://d1bxh8uas1mnw7.cloudfront.net/assets/altmetric_badges-e7ba41a192efc3e63f5d48f8a1916dec4b1b49c01075bc7b39481408957b3b28.js"></script>
    <link id="altmetric-embed-css" rel="stylesheet" type="text/css" href="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed-59614f5c46b49b21eeef3bb28c4fb38d1e7069e8d014752fcb66e84942556802.css">
    <script>
      function on_share() {
        navigator.share({
          url: document.URL,
          title: "Refurboard Field Guide -Refurboard",
        });
      }
    </script>
</head>

<body id="background">
  <div id="background-gradient"></div>
  <content id="content">
  
<a id="share-btn" onclick="on_share()">
  <i class="fa fa-share-alt" alt="üîó"></i>
</a>

  
  <header id="header">
    
    
     
    
    <img id="avatar" src="assets/logo.png" />
    

    
    
    
     
    

    
    
    
     
    <h1 id="title"><a href=.>Refurboard</a></h1>

    
    
    
     
    <ul id="socials">
        
    </ul>

    
    
</header>
  
  <main id="page">
    <nav class="vertical" id="toc">

<ul>

<li class="nav-item">
<a href="#refurboard-field-guide">Refurboard Field Guide</a>
    
    <ul>
    
    
    <li class="nav-subitem">
    <a href="#hardware-checklist">Hardware Checklist</a>
    </li>
    
    
    
    <li class="nav-subitem">
    <a href="#software-stack">Software Stack</a>
    </li>
    
    
    
    <li class="nav-subitem">
    <a href="#installation">Installation</a>
    </li>
    
    
    
    <li class="nav-subitem">
    <a href="#dear-pygui-layout-columnar-ui">Dear PyGui Layout (Columnar UI)</a>
    </li>
    
    
    
    <li class="nav-subitem">
    <a href="#calibration-walkthrough">Calibration Walkthrough</a>
    </li>
    
    
    
    <li class="nav-subitem">
    <a href="#using-phones-as-webcams">Using Phones as Webcams</a>
    </li>
    
    
    
    <li class="nav-subitem">
    <a href="#configuration-file">Configuration File</a>
    </li>
    
    
    
    <li class="nav-subitem">
    <a href="#linux-pointer-control-waylandx11">Linux pointer control (Wayland/X11)</a>
    </li>
    
    
    
    <li class="nav-subitem">
    <a href="#testing-packaging">Testing &amp; Packaging</a>
    </li>
    
    
    
    <li class="nav-subitem">
    <a href="#troubleshooting">Troubleshooting</a>
    </li>
    
    
    
    <li class="nav-subitem">
    <a href="#next-steps">Next Steps</a>
    </li>
    
    
    </ul>
    
</li>

</ul>

</nav>
    <h1 id="refurboard-field-guide">Refurboard Field Guide</h1>
<p>Refurboard resurrects classroom projectors with a modern Python toolchain. Point a USB webcam‚Äîor a phone streaming video through commercial webcam apps like <strong>Camo</strong>, <strong>EpocCam</strong>, or <strong>DroidCam</strong>‚Äîat your display, aim an IR pen, and let OpenCV translate those light trails into mouse movement. The new stack replaces the legacy .NET client with:</p>
<ul>
<li>OpenCV-based IR blob detection with adaptive brightness gating.</li>
<li>Dear PyGui control surface that is intentionally tall and narrow for lecterns and portrait displays.</li>
<li>Fullscreen OpenCV calibration viewport (no nested toolkits, no window chrome). The monitor that shows the overlay is remembered (origin/size + name/index) so cursor movement stays on that display.</li>
<li>Cross-platform packaging through Poetry + PyInstaller with CI artifacts for Windows, macOS, and Linux.</li>
</ul>
<p><img alt="Refurboard UI column" src="../assets/logo.png" /></p>
<h2 id="hardware-checklist">Hardware Checklist</h2>
<table>
<thead>
<tr>
<th>Item</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>IR pen / Wii-style stylus</strong></td>
<td>Any 940 nm LED with a momentary button. Classroom packs from Wii-era whiteboard kits work perfectly.</td>
</tr>
<tr>
<td><strong>Camera</strong></td>
<td>IR-capable USB webcam or phone-as-webcam via commercial apps. Add an external IR-pass filter (or use ready-built ‚Äúnight vision‚Äù cams). 720p @ 30 FPS is sufficient.</td>
</tr>
<tr>
<td><strong>Host OS</strong></td>
<td>Linux: X11 works via pynput/XTest; Wayland requires ydotoold + uinput access (see Linux pointer setup). Windows uses SendInput; macOS uses Quartz CGEvent.</td>
</tr>
<tr>
<td><strong>Display</strong></td>
<td>Projector, TV, or monitor. Calibration assumes a rectangular surface but compensates for keystone with a 3√ó3 homography.</td>
</tr>
</tbody>
</table>
<h2 id="software-stack">Software Stack</h2>
<ul>
<li><strong>Python 3.11+</strong> managed by Poetry.</li>
<li><strong>OpenCV + NumPy</strong> for capture, blob analysis, and homography math.</li>
<li><strong>Dear PyGui</strong> for the main control column (420 px wide, stacked widgets).</li>
<li><strong>Pointer drivers</strong>: ydotool on Linux/Wayland (needs uinput); pynput/XTest on X11; SendInput on Windows; Quartz CGEvent on macOS.</li>
<li><strong>PyInstaller</strong> for single-file binaries.</li>
</ul>
<h2 id="installation">Installation</h2>
<pre><code class="language-bash"># Clone repository
git clone https://github.com/kevinl95/Refurboard.git
cd Refurboard

# Install dependencies
poetry install

# Launch the control surface
poetry run refurboard
</code></pre>
<p>Poetry downloads all runtime dependencies (OpenCV, Dear PyGui, pynput, etc.) and exposes a console script named <code>refurboard</code>.</p>
<h2 id="dear-pygui-layout-columnar-ui">Dear PyGui Layout (Columnar UI)</h2>
<p>The app window is intentionally tall and narrow to sit beside slide decks or OBS scenes. The vertical stack contains:</p>
<ol>
<li><strong>Logo header</strong> ‚Äì uses the PNG assets in <code>/assets</code> for brand consistency.</li>
<li><strong>Camera picker</strong> ‚Äì dropdown listing USB/phone webcams plus a refresh button.</li>
<li><strong>Sensitivity sliders</strong> ‚Äì IR gain and click hysteresis with safe defaults (0.65 / 0.15) but adjustable live.</li>
<li><strong>FoV / corner gain</strong> ‚Äì optional stretch controls to compensate for lens distortion or tight framing.</li>
<li><strong>Calibration button</strong> ‚Äì launches the fullscreen OpenCV viewport on the active display.</li>
<li><strong>Accuracy summary</strong> ‚Äì RMS reprojection error, plus the four collected corner coordinates rendered as a quadrilateral readout.</li>
<li><strong>Live telemetry</strong> ‚Äì normalized pointer coordinates, IR blob intensity, and click state text.</li>
</ol>
<h2 id="calibration-walkthrough">Calibration Walkthrough</h2>
<ol>
<li>Position the camera (or phone-as-webcam feed) so the entire display fits in frame.</li>
<li>Click <strong>Start Calibration</strong>. Refurboard opens a borderless fullscreen OpenCV window.</li>
<li>Four circular targets appear clockwise. Hold the IR pen steady on each target; once the blob is stable for ~10 frames, the point locks automatically.</li>
<li>After all four points, Refurboard computes a homography and reports RMS error. Re-run if the error exceeds ~8 pixels.</li>
</ol>
<p>The display that shows the overlay is the one Refurboard will use for cursor movement in future sessions; monitor name/index and origin/size are persisted in the config.</p>
<p>Because the overlay is an OpenCV window, it works uniformly across Linux, Windows, and macOS without Dear PyGui quirks.</p>
<h2 id="using-phones-as-webcams">Using Phones as Webcams</h2>
<p>Commercial apps expose phones as UVC devices; pick whichever your district approves:</p>
<ul>
<li><strong>Reincubate Camo</strong> (USB/Wi-Fi, iOS + Android) ‚Äì crisp output and stable drivers.</li>
<li><strong>Elgato EpocCam</strong> (USB/Wi-Fi, iOS + Android) ‚Äì simple, widely adopted.</li>
<li><strong>DroidCam</strong> (USB/Wi-Fi, Android + desktop agent) ‚Äì mature and inexpensive.</li>
</ul>
<p>Tips:</p>
<ul>
<li>Prefer USB tethering to avoid Wi-Fi latency.</li>
<li>Lock exposure/ISO inside the app so IR brightness stays predictable.</li>
<li>Mount the phone firmly (tripod, clamp) and disable auto-focus hunting.</li>
</ul>
<h2 id="configuration-file">Configuration File</h2>
<ul>
<li>Stored via PlatformDirs (e.g., <code>~/.local/share/Refurboard/refurboard.config.json</code>).</li>
<li>Contains the active camera ID; detection knobs (sensitivity, hysteresis, smoothing, jitter deadzone <code>min_move_px</code>, FoV scale, per-corner gain); and the latest calibration quadrilateral plus monitor name/index and origin.</li>
<li>Safe to edit between sessions; the UI writes whenever you tweak sliders or complete calibration.</li>
</ul>
<h2 id="linux-pointer-control-waylandx11">Linux pointer control (Wayland/X11)</h2>
<ul>
<li>X11: works out of the box via pynput/XTest.</li>
<li>
<p>Wayland: install <code>ydotool</code> and ensure uinput access:
  1) <code>sudo usermod -aG input $USER</code> then log out/in.
  2) Create udev rule:
      <code>sudo tee /etc/udev/rules.d/70-uinput.rules &gt;/dev/null &lt;&lt;'EOF'
      KERNEL=="uinput", MODE="0660", GROUP="input", TAG+="uaccess", OPTIONS+="static_node=uinput"
      EOF
      sudo udevadm control --reload-rules
      sudo udevadm trigger --subsystem-match=misc --attr-match=name=uinput
      sudo modprobe uinput</code>
  3) Run ydotoold as a user service:
      ```
      mkdir -p ~/.config/systemd/user
      cat &gt; ~/.config/systemd/user/ydotool.service &lt;&lt;'EOF'
      [Unit]
      Description=ydotoold (user)
      After=graphical-session.target</p>
<p>[Service]
  Type=simple
  Environment=XDG_RUNTIME_DIR=/run/user/%U
  ExecStart=/usr/bin/ydotoold --socket-path /run/user/%U/.ydotool_socket
  Restart=on-failure</p>
<p>[Install]
  WantedBy=default.target
  EOF
  systemctl --user daemon-reload
  systemctl --user enable --now ydotool.service
  <code>``
  Verify</code>/run/user/$(id -u)/.ydotool_socket` exists. Refurboard drives the cursor through this socket on Wayland.</p>
</li>
</ul>
<h2 id="testing-packaging">Testing &amp; Packaging</h2>
<pre><code class="language-bash">poetry run pytest                      # run unit tests
poetry run pyinstaller --clean refurboard.spec  # build single-file binary (uses included spec)
</code></pre>
<p>GitHub Actions run tests plus PyInstaller builds on Ubuntu, Windows, and macOS while leaving the existing documentation deployment workflow untouched. The spec bundles OpenCV libs, logo assets, and Quartz modules on macOS.</p>
<h2 id="troubleshooting">Troubleshooting</h2>
<table>
<thead>
<tr>
<th>Symptom</th>
<th>Fix</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Cursor wobbles</strong></td>
<td>Increase smoothing or <code>min_move_px</code> in config; reduce camera gain; ensure tripod stability.</td>
</tr>
<tr>
<td><strong>Clicks misfire</strong></td>
<td>Raise sensitivity or hysteresis so weak reflections keep the click gate open.</td>
</tr>
<tr>
<td><strong>Calibration error &gt; 10 px</strong></td>
<td>Re-run calibration after re-aiming the camera; ensure camera sees every corner and minimize bright IR reflections.</td>
</tr>
<tr>
<td><strong>Pointer on wrong monitor</strong></td>
<td>Re-run calibration on the intended display; the app remembers that monitor.</td>
</tr>
<tr>
<td><strong>Wayland: cursor does not move</strong></td>
<td>Ensure <code>ydotoold</code> user service is running and <code>/run/user/$(id -u)/.ydotool_socket</code> exists; add user to <code>input</code>, apply the udev rule for <code>/dev/uinput</code>, reload <code>uinput</code>.</td>
</tr>
</tbody>
</table>
<h2 id="next-steps">Next Steps</h2>
<ul>
<li>Expand wiki with printable classroom posters for IR pen care and alignment tips.</li>
<li>Add automated FoV overlay export for projector alignment reference.</li>
</ul>
    <nav id="page-controls">
      <a href="#content" id="return-top">
        <i class="fa fa-arrow-up" alt="‚áß"></i> Return to top
      </a>
    </nav>
  </main>
  </content>
  <footer id="footer">
    

<p>Compiled from markdown using <a href="https://www.mkdocs.org/">MkDocs</a>. Theme is <a href="https://teparsons.github.io/mkdocs-landing/">Landing</a> by <a href="https://toddparsons.co.uk">Todd Parsons</a>.</p>












<a id=page-source href=https://github.com/kevinl95/Refurboard><i class="fa-brands fa-github"></i> Page source</a>



<script src="search/main.js"></script>

  </footer>
</body>

</html>